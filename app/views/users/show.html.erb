<!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
<script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
<script src="https://openlayers.org/en/v4.0.1/build/ol.js"></script>
<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<div class="container">
 <div class="row">

   <div class="col-md-12">
   <h2>Name:</h2>
     <p><%= @user.first_name %>
     <%= @user.last_name %></p><br>
     <%= form_for @user do |profile| %>
     <%= image_tag @user.profile.thumb.url if @user.profile? %><br>
     <h4><%= profile.label :edit_profile_picture %></h4>
     <%= profile.file_field :profile %><br>
     <%= profile.button 'Upload', type: 'submit' %>
     <% end %>
   </div>
 </div>
</div>

<h2>Pinned places:</h2>

<div class="container">

  <div class="row">

    <div class="col-md-1">
    </div>

    <div class="col-md-10">
      <div id="map" class="map">
      </div>
      <script type="text/javascript">
        var layer = new ol.layer.Tile({
          source: new ol.source.OSM()
        });

        var map = new ol.Map({
          layers: [layer],
          target: 'map',
          view: new ol.View({
            center: [0,0],
            zoom: 2
          })
        });
      </script>
      <div style="display: none;">

        <% @u_reviews.all.each do |pinned| %>

          <div id="marker_<%= pinned.id %>" title="pin_<%= pinned.place.id %>">
            <i class="material-icons" style="color: red;">location_on</i>
          </div>

          <script type="text/javascript">
            var pos = ol.proj.fromLonLat([<%= pinned.place.longitude %>, <%= pinned.place.latitude %>]);

            // individual markers
            var marker = new ol.Overlay({
              position: pos,
              positioning: 'center-center',
              element: document.getElementById("marker_<%= pinned.id %>"),
              stopEvent: false
            });
            map.addOverlay(marker);
          </script>
        <% end %>
      </div>
    </div>

   <div class="col-md-1">
   </div>

 </div>

</div>

<!-- <script>
 // City label
 var city = new ol.Overlay({
   position: pos,
   element: document.getElementById('city')
 });
 map.addOverlay(city);

</script> -->

<style>

  #marker {
    width: 20px;
    height: 20px;
    border-radius: 10px;
  }

  #map {
    position: relative;
  }

</style>    